{"version":3,"file":"ripple.js","sourceRoot":"","sources":["../../src/directives/ripple.ts"],"names":[],"mappings":"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","sourcesContent":["import { VNodeDirective } from 'vue'\n\nfunction style (el: HTMLElement, value: string) {\n  el.style['transform'] = value\n  el.style['webkitTransform'] = value\n}\n\ndeclare global {\n  interface Element {\n    getElementsByClassName(classNames: string): NodeListOf<HTMLElement>\n  }\n\n  interface HTMLElement {\n    _ripple: undefined | {\n      enabled?: boolean\n      centered?: boolean\n      class?: string\n    }\n  }\n}\n\ninterface RippleOptions {\n  class?: string\n  center?: boolean\n}\n\nconst ripple = {\n  show (e: MouseEvent, el: HTMLElement, value: RippleOptions = {}) {\n    if (!el._ripple || !el._ripple.enabled) {\n      return\n    }\n\n    const container = document.createElement('span')\n    const animation = document.createElement('span')\n\n    container.appendChild(animation)\n    container.className = 'v-ripple__container'\n\n    if (value.class) {\n      container.className += ` ${value.class}`\n    }\n\n    const size = Math.max(el.clientWidth, el.clientHeight) * (value.center ? 1 : 2)\n    const halfSize = size / 2\n    animation.className = 'v-ripple__animation'\n    animation.style.width = `${size}px`\n    animation.style.height = `${size}px`\n\n    el.appendChild(container)\n    const computed = window.getComputedStyle(el)\n    if (computed.position !== 'absolute' && computed.position !== 'fixed') el.style.position = 'relative'\n\n    const offset = el.getBoundingClientRect()\n    const x = value.center ? 0 : e.clientX - offset.left - halfSize\n    const y = value.center ? 0 : e.clientY - offset.top - halfSize\n\n    animation.classList.add('v-ripple__animation--enter')\n    animation.classList.add('v-ripple__animation--visible')\n    style(animation, `translate(${x}px, ${y}px) scale3d(0, 0, 0)`)\n    animation.dataset.activated = String(performance.now())\n\n    setTimeout(() => {\n      animation.classList.remove('v-ripple__animation--enter')\n      style(animation, `translate(${x}px, ${y}px)  scale3d(1, 1, 1)`)\n    }, 0)\n  },\n\n  hide (el: HTMLElement | null) {\n    if (!el || !el._ripple || !el._ripple.enabled) return\n\n    const ripples = el.getElementsByClassName('v-ripple__animation')\n\n    if (ripples.length === 0) return\n    const animation = ripples[ripples.length - 1]\n\n    if (animation.dataset.isHiding) return\n    else animation.dataset.isHiding = 'true'\n\n    const diff = performance.now() - Number(animation.dataset.activated)\n    let delay = Math.max(300 - diff, 0)\n\n    setTimeout(() => {\n      animation.classList.remove('v-ripple__animation--visible')\n\n      setTimeout(() => {\n        const ripples = el.getElementsByClassName('v-ripple__animation')\n        if (ripples.length === 0) el.style.position = null\n        animation.parentNode && el.removeChild(animation.parentNode)\n      }, 300)\n    }, delay)\n  }\n}\n\nfunction isRippleEnabled (value: any): value is true {\n  return typeof value === 'undefined' || !!value\n}\n\nfunction rippleShow (e: MouseEvent) {\n  const value: RippleOptions = {}\n  const element = e.currentTarget as HTMLElement\n  if (!element) return\n  value.center = element._ripple!.centered\n  if (element._ripple!.class) {\n    value.class = element._ripple!.class\n  }\n  ripple.show(e, element, value)\n}\n\nfunction rippleHide (e: Event) {\n  ripple.hide(e.currentTarget as HTMLElement | null)\n}\n\nfunction updateRipple (el: HTMLElement, binding: VNodeDirective, wasEnabled: boolean) {\n  const enabled = isRippleEnabled(binding.value)\n  if (!enabled) {\n    ripple.hide(el)\n  }\n  el._ripple = el._ripple || {}\n  el._ripple.enabled = enabled\n  const value = binding.value || {}\n  if (value.center) {\n    el._ripple.centered = true\n  }\n  if (value.class) {\n    el._ripple.class = binding.value.class\n  }\n  if (enabled && !wasEnabled) {\n    if ('ontouchstart' in window) {\n      el.addEventListener('touchend', rippleHide, false)\n      el.addEventListener('touchcancel', rippleHide, false)\n    }\n\n    el.addEventListener('mousedown', rippleShow, false)\n    el.addEventListener('mouseup', rippleHide, false)\n    el.addEventListener('mouseleave', rippleHide, false)\n    // Anchor tags can be dragged, causes other hides to fail - #1537\n    el.addEventListener('dragstart', rippleHide, false)\n  } else if (!enabled && wasEnabled) {\n    removeListeners(el)\n  }\n}\n\nfunction removeListeners (el: HTMLElement) {\n  el.removeEventListener('mousedown', rippleShow, false)\n  el.removeEventListener('touchend', rippleHide, false)\n  el.removeEventListener('touchcancel', rippleHide, false)\n  el.removeEventListener('mouseup', rippleHide, false)\n  el.removeEventListener('mouseleave', rippleHide, false)\n  el.removeEventListener('dragstart', rippleHide, false)\n}\n\nfunction directive (el: HTMLElement, binding: VNodeDirective) {\n  updateRipple(el, binding, false)\n}\n\nfunction unbind (el: HTMLElement) {\n  delete el._ripple\n  removeListeners(el)\n}\n\nfunction update (el: HTMLElement, binding: VNodeDirective) {\n  if (binding.value === binding.oldValue) {\n    return\n  }\n\n  const wasEnabled = isRippleEnabled(binding.oldValue)\n  updateRipple(el, binding, wasEnabled)\n}\n\nexport default {\n  name: 'ripple',\n  bind: directive,\n  unbind: unbind,\n  update: update\n}\n"]}