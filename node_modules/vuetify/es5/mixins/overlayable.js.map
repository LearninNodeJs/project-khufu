{"version":3,"file":"overlayable.js","sourceRoot":"","sources":["../../src/mixins/overlayable.js"],"names":[],"mappings":"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","sourcesContent":["import '../stylus/components/_overlay.styl'\n\n// Utils\nimport { keyCodes } from '../util/helpers'\n\nexport default {\n  name: 'overlayable',\n\n  data () {\n    return {\n      overlay: null,\n      overlayOffset: 0,\n      overlayTimeout: null,\n      overlayTransitionDuration: 500 + 150 // transition + delay\n    }\n  },\n\n  props: {\n    hideOverlay: Boolean\n  },\n\n  beforeDestroy () {\n    this.removeOverlay()\n  },\n\n  methods: {\n    genOverlay () {\n      // If fn is called and timeout is active\n      // or overlay already exists\n      // cancel removal of overlay and re-add active\n      if ((!this.isActive || this.hideOverlay) ||\n        (this.isActive && this.overlayTimeout) ||\n        this.overlay\n      ) {\n        clearTimeout(this.overlayTimeout)\n\n        return this.overlay &&\n          this.overlay.classList.add('v-overlay--active')\n      }\n\n      this.overlay = document.createElement('div')\n      this.overlay.className = 'v-overlay'\n\n      if (this.absolute) this.overlay.className += ' v-overlay--absolute'\n\n      this.hideScroll()\n\n      const parent = this.absolute\n        ? this.$el.parentNode\n        : document.querySelector('[data-app]')\n\n      parent && parent.insertBefore(this.overlay, parent.firstChild)\n\n      // eslint-disable-next-line no-unused-expressions\n      this.overlay.clientHeight // Force repaint\n      requestAnimationFrame(() => {\n        this.overlay.className += ' v-overlay--active'\n\n        if (this.activeZIndex !== undefined) {\n          this.overlay.style.zIndex = this.activeZIndex - 1\n        }\n      })\n\n      return true\n    },\n    removeOverlay () {\n      if (!this.overlay) {\n        return this.showScroll()\n      }\n\n      this.overlay.classList.remove('v-overlay--active')\n\n      this.overlayTimeout = setTimeout(() => {\n        // IE11 Fix\n        try {\n          if (this.overlay && this.overlay.parentNode) {\n            this.overlay.parentNode.removeChild(this.overlay)\n          }\n          this.overlay = null\n          this.showScroll()\n        } catch (e) { console.log(e) }\n\n        clearTimeout(this.overlayTimeout)\n        this.overlayTimeout = null\n      }, this.overlayTransitionDuration)\n    },\n    /**\n     * @param {Event} e\n     * @returns void\n     */\n    scrollListener (e) {\n      if (e.type === 'keydown') {\n        if (['INPUT', 'TEXTAREA', 'SELECT'].includes(e.target.tagName)) return\n\n        const up = [keyCodes.up, keyCodes.pageup]\n        const down = [keyCodes.down, keyCodes.pagedown]\n\n        if (up.includes(e.keyCode)) {\n          e.deltaY = -1\n        } else if (down.includes(e.keyCode)) {\n          e.deltaY = 1\n        } else {\n          return\n        }\n      }\n\n      if (e.target === this.overlay ||\n        (e.type !== 'keydown' && e.target === document.body) ||\n        this.checkPath(e)) e.preventDefault()\n    },\n    hasScrollbar (el) {\n      if (!el || el.nodeType !== Node.ELEMENT_NODE) return false\n\n      const style = window.getComputedStyle(el)\n      return ['auto', 'scroll'].includes(style['overflow-y']) && el.scrollHeight > el.clientHeight\n    },\n    shouldScroll (el, delta) {\n      if (el.scrollTop === 0 && delta < 0) return true\n      return el.scrollTop + el.clientHeight === el.scrollHeight && delta > 0\n    },\n    isInside (el, parent) {\n      if (el === parent) {\n        return true\n      } else if (el === null || el === document.body) {\n        return false\n      } else {\n        return this.isInside(el.parentNode, parent)\n      }\n    },\n    /**\n     * @param {Event} e\n     * @returns boolean\n     */\n    checkPath (e) {\n      const path = e.path || this.composedPath(e)\n      const delta = e.deltaY || -e.wheelDelta\n\n      if (e.type === 'keydown' && path[0] === document.body) {\n        const dialog = this.$refs.dialog\n        const selected = window.getSelection().anchorNode\n        if (this.hasScrollbar(dialog) && this.isInside(selected, dialog)) {\n          return this.shouldScroll(dialog, delta)\n        }\n        return true\n      }\n\n      for (let index = 0; index < path.length; index++) {\n        const el = path[index]\n\n        if (el === document) return true\n        if (el === document.documentElement) return true\n        if (el === this.$refs.content) return true\n\n        if (this.hasScrollbar(el)) return this.shouldScroll(el, delta)\n      }\n\n      return true\n    },\n    /**\n     * Polyfill for Event.prototype.composedPath\n     * @param {Event} e\n     * @returns Element[]\n     */\n    composedPath (e) {\n      if (e.composedPath) return e.composedPath()\n\n      const path = []\n      let el = e.target\n\n      while (el) {\n        path.push(el)\n\n        if (el.tagName === 'HTML') {\n          path.push(document)\n          path.push(window)\n\n          return path\n        }\n\n        el = el.parentElement\n      }\n    },\n    hideScroll () {\n      if (this.$vuetify.breakpoint.smAndDown) {\n        document.documentElement.classList.add('overflow-y-hidden')\n      } else {\n        window.addEventListener('wheel', this.scrollListener)\n        window.addEventListener('keydown', this.scrollListener)\n      }\n    },\n    showScroll () {\n      document.documentElement.classList.remove('overflow-y-hidden')\n      window.removeEventListener('wheel', this.scrollListener)\n      window.removeEventListener('keydown', this.scrollListener)\n    }\n  }\n}\n"]}