{"version":3,"file":"VTimePickerClock.js","sourceRoot":"","sources":["../../../src/components/VTimePicker/VTimePickerClock.js"],"names":[],"mappings":"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","sourcesContent":["import '../../stylus/components/_time-picker-clock.styl'\n\n// Mixins\nimport Colorable from '../../mixins/colorable'\nimport Themeable from '../../mixins/themeable'\n\nexport default {\n  name: 'v-time-picker-clock',\n\n  mixins: [\n    Colorable,\n    Themeable\n  ],\n\n  data () {\n    return {\n      defaultColor: 'accent',\n      inputValue: this.value,\n      isDragging: false\n    }\n  },\n\n  props: {\n    allowedValues: Function,\n    double: Boolean,\n    format: {\n      type: Function,\n      default: val => val\n    },\n    max: {\n      type: Number,\n      required: true\n    },\n    min: {\n      type: Number,\n      required: true\n    },\n    scrollable: Boolean,\n    rotate: {\n      type: Number,\n      default: 0\n    },\n    size: {\n      type: [Number, String],\n      default: 270\n    },\n    step: {\n      type: Number,\n      default: 1\n    },\n    value: Number\n  },\n\n  computed: {\n    count () {\n      return this.max - this.min + 1\n    },\n    innerRadius () {\n      return this.radius - Math.max(this.radius * 0.4, 48)\n    },\n    outerRadius () {\n      return this.radius - 4\n    },\n    roundCount () {\n      return this.double ? (this.count / 2) : this.count\n    },\n    degreesPerUnit () {\n      return 360 / this.roundCount\n    },\n    degrees () {\n      return this.degreesPerUnit * Math.PI / 180\n    },\n    radius () {\n      return this.size / 2\n    },\n    displayedValue () {\n      return this.value == null ? this.min : this.value\n    }\n  },\n\n  watch: {\n    value (value) {\n      this.inputValue = value\n    }\n  },\n\n  methods: {\n    wheel (e) {\n      e.preventDefault()\n      const value = this.displayedValue + Math.sign(e.wheelDelta || 1)\n      this.update((value - this.min + this.count) % this.count + this.min)\n    },\n    handScale (value) {\n      return this.double && (value - this.min >= this.roundCount) ? (this.innerRadius / this.radius) : (this.outerRadius / this.radius)\n    },\n    isAllowed (value) {\n      return !this.allowedValues || this.allowedValues(value)\n    },\n    genValues () {\n      const children = []\n\n      for (let value = this.min; value <= this.max; value = value + this.step) {\n        const classes = {\n          active: value === this.displayedValue,\n          disabled: !this.isAllowed(value)\n        }\n\n        children.push(this.$createElement('span', {\n          'class': this.addBackgroundColorClassChecks(classes, value === this.value ? this.computedColor : null),\n          style: this.getTransform(value),\n          domProps: { innerHTML: `<span>${this.format(value)}</span>` }\n        }))\n      }\n\n      return children\n    },\n    genHand () {\n      const scale = `scaleY(${this.handScale(this.displayedValue)})`\n      const angle = this.rotate + this.degreesPerUnit * (this.displayedValue - this.min)\n\n      return this.$createElement('div', {\n        staticClass: 'v-time-picker-clock__hand',\n        'class': this.value == null ? {} : this.addBackgroundColorClassChecks(),\n        style: {\n          transform: `rotate(${angle}deg) ${scale}`\n        }\n      })\n    },\n    getTransform (i) {\n      const { x, y } = this.getPosition(i)\n      return { transform: `translate(${x}px, ${y}px)` }\n    },\n    getPosition (value) {\n      const radius = (this.radius - 24) * this.handScale(value)\n      const rotateRadians = this.rotate * Math.PI / 180\n      return {\n        x: Math.round(Math.sin((value - this.min) * this.degrees + rotateRadians) * radius),\n        y: Math.round(-Math.cos((value - this.min) * this.degrees + rotateRadians) * radius)\n      }\n    },\n    onMouseDown (e) {\n      e.preventDefault()\n\n      this.isDragging = true\n      this.onDragMove(e)\n    },\n    onMouseUp () {\n      this.isDragging = false\n      this.isAllowed(this.inputValue) && this.$emit('change', this.inputValue)\n    },\n    onDragMove (e) {\n      e.preventDefault()\n      if (!this.isDragging && e.type !== 'click') return\n\n      const { width, top, left } = this.$refs.clock.getBoundingClientRect()\n      const { clientX, clientY } = 'touches' in e ? e.touches[0] : e\n      const center = { x: width / 2, y: -width / 2 }\n      const coords = { x: clientX - left, y: top - clientY }\n      const handAngle = Math.round(this.angle(center, coords) - this.rotate + 360) % 360\n      const insideClick = this.double && this.euclidean(center, coords) < (this.outerRadius + this.innerRadius) / 2 - 16\n      const value = Math.round(handAngle / this.degreesPerUnit) +\n        this.min + (insideClick ? this.roundCount : 0)\n\n      // Necessary to fix edge case when selecting left part of max value\n      if (handAngle >= (360 - this.degreesPerUnit / 2)) {\n        this.update(insideClick ? this.max : this.min)\n      } else {\n        this.update(value)\n      }\n    },\n    update (value) {\n      if (this.inputValue !== value && this.isAllowed(value)) {\n        this.inputValue = value\n        this.$emit('input', value)\n      }\n    },\n    euclidean (p0, p1) {\n      const dx = p1.x - p0.x\n      const dy = p1.y - p0.y\n\n      return Math.sqrt(dx * dx + dy * dy)\n    },\n    angle (center, p1) {\n      const value = 2 * Math.atan2(p1.y - center.y - this.euclidean(center, p1), p1.x - center.x)\n      return Math.abs(value * 180 / Math.PI)\n    }\n  },\n\n  render () {\n    const data = {\n      staticClass: 'v-time-picker-clock',\n      class: {\n        'v-time-picker-clock--indeterminate': this.value == null\n      },\n      on: {\n        mousedown: this.onMouseDown,\n        mouseup: this.onMouseUp,\n        mouseleave: () => (this.isDragging && this.onMouseUp()),\n        touchstart: this.onMouseDown,\n        touchend: this.onMouseUp,\n        mousemove: this.onDragMove,\n        touchmove: this.onDragMove\n      },\n      style: {\n        height: `${this.size}px`,\n        width: `${this.size}px`\n      },\n      ref: 'clock'\n    }\n\n    this.scrollable && (data.on.wheel = this.wheel)\n\n    return this.$createElement('div', data, [\n      this.genHand(),\n      this.genValues()\n    ])\n  }\n}\n"]}